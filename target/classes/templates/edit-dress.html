<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Edit Product</title>
	<style>
		body {
			font-family: Arial, sans-serif;
			background-color: deepskyblue;
			margin: 0;
			padding: 0;
			display: flex;
			justify-content: center;
			align-items: center;
			height: 100vh;
		}

		.form-container {
			background-color: #ffffff;
			padding: 20px;
			border-radius: 8px;
			box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
			width: 100%;
			max-width: 400px;
			max-height: 80vh;
			overflow-y: auto;
			display: flex;
			flex-direction: column;
			align-items: center;
		}

		h1 {
			text-align: center;
			color: #333;
		}

		label {
			display: block;
			margin-bottom: 8px;
			color: #555;
		}

		input[type="text"],
		textarea {
			width: 100%;
			padding: 10px;
			margin-bottom: 15px;
			border: 1px solid #ccc;
			border-radius: 4px;
		}

		input[type="file"] {
			margin-bottom: 15px;
		}

		button {
			width: 45%;
			padding: 10px;
			background-color: #28a745;
			color: #fff;
			border: none;
			border-radius: 4px;
			cursor: pointer;
			margin-right: 5px;
		}

		button:last-child {
			margin-right: 0;
		}

		button:hover {
			background-color: #218838;
		}

		.cancel-button {
			background-color: #dc3545;
		}

		.cancel-button:hover {
			background-color: #c82333;
		}

		#imagePreview {
			width: 240px;
			height: auto;
			margin-top: 15px;
			border-radius: 4px;
			border: 1px solid #ccc;
		}
	</style>
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" />
</head>

<body>
	<div th:replace="navbar.html"></div>
	<div class="form-container">
		<h1>Edit Product</h1>
		<form th:action="@{|${baseUrl}/edit-dress|}" method="post" enctype="multipart/form-data"
			th:object="${productForm}">
			<!-- Hidden field to emulate PUT method -->
			<input type="hidden" name="_method" value="put" />
			<div th:if="${baseUrl} == '/mens'">
				<div>
					<label for="id">id (Men's):</label>
					<input type="text" id="id" name="id" th:field="*{product.id}" readonly>
				</div>
				<div>
					<label for="name">Name (Men's):</label>
					<input type="text" id="name" name="name" th:field="*{product.name}" required>
				</div>
				<div>
					<label for="category">Category (Men's):</label>
					<input type="text" id="category" name="category" th:field="*{product.category}" required>
				</div>
				<div>
					<label for="description">Description (Men's):</label>
					<textarea id="description" name="description" th:field="*{product.description}" required></textarea>
				</div>
				<div>
					<label for="price">Price (Men's):</label>
					<input type="number" id="price" name="price" th:field="*{product.price}" required>
				</div>
				<div>
					<label for="size">Size (Men's):</label>
					<select id="size" name="size" th:if="${baseUrl} == '/mens'" th:field="*{product.size}" required>
						<option value="small">S</option>
						<option value="medium">M</option>
						<option value="large">L</option>
						<option value="extra-large">XL</option>
					</select>
				</div>
				<div>
					<label for="color">Color (Men's):</label>
					<input type="text" id="color" name="color" th:field="*{product.color}" required>
				</div>
				<div>
					<label for="rating">Rating (Men's):</label>
					<input type="text" id="rating" name="rating" th:field="*{product.rating}" required>
				</div>
			</div>

			<div th:if="${baseUrl} == '/womens'">
				<div>
					<label for="id">id (Women's):</label>
					<input type="text" id="id" name="id" th:field="*{womensDress.id}" readonly>
				</div>
				<div>
					<label for="name">Name (Women's):</label>
					<input type="text" id="name" name="name" th:field="*{womensDress.name}" required>
				</div>
				<div>
					<label for="category">Category (Women's):</label>
					<input type="text" id="category" name="category" th:field="*{womensDress.category}" required>
				</div>
				<div>
					<label for="description">Description (Women's):</label>
					<textarea id="description" name="description" th:field="*{womensDress.description}"
						required></textarea>
				</div>
				<div>
					<label for="price">Price (Women's):</label>
					<input type="number" id="price" name="price" th:field="*{womensDress.price}" required>
				</div>
				<div>
					<label for="size">Size (Women's'):</label>
					<select id="size" name="size" th:if="${baseUrl} == '/womens'" th:field="*{womensDress.size}"
						required>
						<option value="small">S</option>
						<option value="medium">M</option>
						<option value="large">L</option>
						<option value="extra-large">XL</option>
					</select>
				</div>
				<div>
					<label for="color">Color (Women's):</label>
					<input type="text" id="color" name="color" th:field="*{womensDress.color}" required>
				</div>
				<div>
					<label for="rating">Rating (Women's):</label>
					<input type="text" id="rating" name="rating" th:field="*{womensDress.rating}" required>
				</div>
			</div>

			<div th:if="${baseUrl} == '/kids'">
				<div></div>
				<label for="id">id (Kids):</label>
				<input type="text" id="id" name="id" th:field="*{kidsDress.id}" readonly>
				<div>
					<label for="name">Name (Kids):</label>
					<input type="text" id="name" name="name" th:field="*{kidsDress.name}" required>
				</div>
				<div>
					<label for="category">Category (Kids):</label>
					<input type="text" id="category" name="category" th:field="*{kidsDress.category}" required>
				</div>
				<div>
					<label for="description">Description (Kids):</label>
					<textarea id="description" name="description" th:field="*{kidsDress.description}"
						required></textarea>
				</div>
				<div>
					<label for="price">Price (Kids):</label>
					<input type="number" id="price" name="price" th:field="*{kidsDress.price}" required>
				</div>
				<div>
					<label for="size">Size (Kids):</label>
					<select id="size" name="size" th:if="${baseUrl} == '/kids'" th:field="*{kidsDress.size}" required>
						<option value="small">S</option>
						<option value="medium">M</option>
						<option value="large">L</option>
						<option value="extra-large">XL</option>
					</select>
				</div>
				<div>
					<label for="color">Color (Kid's):</label>
					<input type="text" id="color" name="color" th:field="*{kidsDress.color}" required>
				</div>
				<div>
					<label for="rating">Rating (Kid's):</label>
					<input type="text" id="rating" name="rating" th:field="*{kidsDress.rating}" required>
				</div>

			</div>
			<!-- Image Field -->
			<div>
				<label for="image">Image:</label>
				<input type="file" id="image" name="image" accept="image/*" onchange="previewImage(event)">
			</div>

			<!-- Hidden Field for Old Image -->
			<div th:if="${baseUrl} == '/mens'">
				<input type="hidden" id="old" name="old" th:field="*{product.image}">
			</div>
			<div th:if="${baseUrl} == '/womens'">
				<input type="hidden" id="old" name="old" th:field="*{womensDress.image}">
			</div>
			<div th:if="${baseUrl} == '/kids'">
				<input type="hidden" id="old" name="old" th:field="*{kidsDress.image}">
			</div>

			<!-- Image Preview -->
			<div>
				<img id="imagePreview" th:if="${baseUrl} == '/mens' and ${productForm.product.image != null}"
					th:src="'data:image/jpeg;base64,' + ${base64Image}" alt="Image Preview" />
				<img id="imagePreview" th:if="${baseUrl} == '/womens' and ${productForm.womensDress.image != null}"
					th:src="'data:image/jpeg;base64,' + ${base64Image}" alt="Image Preview" />
				<img id="imagePreview" th:if="${baseUrl} == '/kids' and ${productForm.kidsDress.image != null}"
					th:src="'data:image/jpeg;base64,' + ${base64Image}" alt="Image Preview" />
				<!-- If no image is present, show a placeholder -->
				<img id="imagePreview" th:if="${baseUrl} == '/mens' and ${productForm.product.image == null}" src="#"
					alt="Image Preview" style="display:none;" />
				<img id="imagePreview" th:if="${baseUrl} == '/womens' and ${productForm.womensDress.image == null}"
					src="#" alt="Image Preview" style="display:none;" />
				<img id="imagePreview" th:if="${baseUrl} == '/kids' and ${productForm.kidsDress.image == null}" src="#"
					alt="Image Preview" style="display:none;" />
			</div>

			<!-- Form Submission Buttons -->
			<div class="button-container">
				<input type="submit" class="btn btn-primary" value="Submit" />
				<a href="/" class="btn btn-danger">Cancel</a>
			</div>
		</form>
	</div>

	<script>
		function previewImage(event) {
			var input = event.target;
			var reader = new FileReader();
			reader.onload = function () {
				var dataURL = reader.result;
				var imagePreview = document.getElementById('imagePreview');
				imagePreview.src = dataURL;
				imagePreview.style.display = 'block';
			};
			reader.readAsDataURL(input.files[0]);
		}
	</script>
</body>

</html>